webpackJsonp([3],{"/1dm":function(t,e){},MGFQ:function(t,e){},NSyc:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("woOf"),s=i.n(a),l=i("Dd8w"),o=i.n(l),n=i("NYxO"),c=i("tFWz"),r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"video-player-content",style:{transform:"translate3d("+this.offset+"%, 0, 0)"}},[this.link?e("video",{staticClass:"video",attrs:{src:this.link,controls:"controls"}},[this._v("\n  your browser does not support the video tag\n  ")]):this._e(),this._v(" "),e("div",{staticClass:"back-wrap",on:{click:this.closePlayer}},[e("span",{staticClass:"fa fa-reply"})])])},staticRenderFns:[]};var h=i("VU/8")({data:function(){return{offset:100,link:""}},methods:{closePlayer:function(){this.isShow(!1),this.link=""},setVideoData:function(t){this.isShow(!0),this.link=t.url},isShow:function(t){this.offset=t?0:100}}},r,!1,function(t){i("/1dm")},"data-v-da7defd2",null).exports,d=i("Mlu6"),u=i("M9A7"),f=Object(u.c)(),p={props:{loadStart:{type:Boolean,default:!1},KeyWord:{type:String,default:""},KeyValue:{type:String,default:""}},data:function(){return{config:{},picFileAttach:[],officeFileAttach:[],mediaFileAttach:[],otherFileAttach:[],fileLink:"",offset:100,configInit:!1,imgLocalIdArray:[],imgServerIdArray:[],upStatusWX:!1,upStatus:!1}},created:function(){this.host=Object(d.s)("production"),this.wx=this.$wechat},computed:o()({formstate:function(){return this.routerParams.formstate},isEdit:function(){var t=this.routerParams.formstate;switch(this.formStatusValue){case"40":case"50":return!1;default:return"view"!==t}}},Object(n.c)(["routerParams","formStatusValue"])),methods:o()({previewFile:function(t){var e=location.origin+"/PowerPlat/Control/File.ashx?action=browser&_type=ftp&_fileid="+t.Id,i=t.FileSize?parseInt(t.FileSize):1048576;try{this.wx.previewFile({url:e,name:t.Name||"",size:i})}catch(t){window.open(e)}},previewImage:function(t,e){var i="/Hoter/showFile?token="+f+"&fileId=",a=[],s=""+i+t.Id;this.picFileAttach.map(function(t){var e=""+i+t.Id;a.push(e)}),this.$createImagePreview({imgs:a,initialIndex:e+1}).show(),this.wx.previewImage({current:s,urls:a})},previewVideo:function(t){var e="/Hoter/showFile?token="+f+"&fileId="+t.Id,i=e;this.$refs.player.setVideoData({url:i})},getConfig:function(){var t=this,e=location.href.split("#")[0];this.GetJsSdkData(e).then(function(e){t.config=s()({},e.data),t.config.jsApiList=t.config.jsApiList.concat(["previewFile"]),t.wx.config(t.config),t.configInit=!0}).catch(function(e){t.configInit=!1,t.AlertShowEvent(e.message)})},upLoad:function(){var t=this;window.useWeixinUpload?this.addImageFile(function(){t.upLoadFileWX()}):this.UploadFile=new d.a(f,this.KeyValue,this.KeyWord,function(){t.GetDocFilesLoad(t.KeyWord,t.KeyValue),t.ToastShowEvent("上传成功~~")},function(e){t.AlertShowEvent(e.message)})},addImageFile:function(t){if(this.upStatus=!1,this.upStatusWX=!1,!this.configInit)return this.AlertShowEvent("微信配置初始化失败，请刷新重试"),!1;var e=this;this.wx.chooseImage({sourceType:["album","camera"],sizeType:["compressed"],success:function(i){e.imgLocalIdArray=i.localIds.concat(),t&&t()}})},upLoadFileWX:function(){var t=this;if(this.imgLocalIdArray.length>0){var e=this.imgLocalIdArray.shift();this.wx.uploadImage({localId:e,isShowProgressTips:1,success:function(e){t.imgServerIdArray.push(e.serverId),0===t.imgLocalIdArray.length?t.upLoadFile():t.upLoadFileWX()}})}},upLoadFile:function(){var t=this,e={imgServerIds:this.imgServerIdArray.concat().join(","),KeyValue:this.KeyValue,KeyWord:this.KeyWord};this.AddImageData(e).then(function(e){t.imgServerIdArray=[],t.ToastShowEvent("上传成功"),t.GetDocFilesLoad(t.KeyWord,t.KeyValue)}).catch(function(e){t.AlertShowEvent(e.message)})},closeFile:function(){var t=this;this.offset=100,this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){t.fileLink=""},400)},showFile:function(t){this.fileLink=this.host+"/PowerPlat/FormXml/FileViewer.aspx?online=1&fileid="+t.Id,this.offset=0},deleteFile:function(t){var e=this;this.deleteFileData(t.Id).then(function(t){e.ToastShowEvent("删除成功~~"),e.GetDocFilesLoad(e.KeyWord,e.KeyValue)}).catch(function(t){e.AlertShowEvent(t.message)})},GetDocFilesLoad:function(t,e){var i=this,a={KeyWord:t,KeyValue:e,index:"0",size:"0",sort:"",select:"",swhere:""};this.GetDocFilesData(a).then(function(t){var e=t.data.value,a=[];""!==e&&(a=JSON.parse(e)),i.checkFileKinds(a)}).catch(function(t){i.AlertShowEvent(t.message)})},checkFileKinds:function(t){for(var e=/\.(png|jpe?g|gif|svg)(\?.*)?$/,i=/\.(mp4|webm|ogg|mp3|wav|flac|aac)(\?.*)?$/,a=/\.(doc|docx|docm|dot|dotx|dotm|pdf|xls|xlsx|xlsm|xlt|xltx|xltm|csv|ppt|pptx|pptm|pot|potx|potm|pps|ppsx|ppsm)(\?.*)?$/,s=[],l=[],o=[],n=[],c=0;c<t.length;c++){var r=t[c];e.test(r.FileExt)?s.push(r):i.test(r.FileExt)?l.push(r):a.test(r.FileExt)?o.push(r):n.push(r)}this.picFileAttach=s,this.mediaFileAttach=l,this.officeFileAttach=o,this.otherFileAttach=n}},Object(n.b)(["GetDocFilesData","deleteFileData","GetJsSdkData","AddImageData","AlertShowEvent","ToastShowEvent"])),watch:{loadStart:{handler:function(t,e){this.loadStart&&(this.GetDocFilesLoad(this.KeyWord,this.KeyValue),window.useWeixinUpload&&this.getConfig())},immediate:!0}},components:{AttachList:c.a,player:h}},v={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"file-attach"},[i("div",{staticClass:"file-attach-inner"},[i("form",{staticClass:"file-attach-content"},[t.picFileAttach.length>0?i("div",{staticClass:"file-attach-type"},[i("h1",{staticClass:"type-title"},[t._v("图片")]),t._v(" "),i("ul",{staticClass:"file-attach-lists"},t._l(t.picFileAttach,function(e,a){return i("li",{key:e.Id,staticClass:"file-attach-list",on:{click:function(i){return i.stopPropagation(),i.preventDefault(),t.previewImage(e,a)}}},[i("attach-list",{attrs:{isEdit:t.isEdit,attachList:e},on:{deleteFile:t.deleteFile}})],1)}),0)]):t._e(),t._v(" "),t.mediaFileAttach.length>0?i("div",{staticClass:"file-attach-type"},[i("h1",{staticClass:"type-title"},[t._v("视频")]),t._v(" "),i("ul",{staticClass:"file-attach-lists"},t._l(t.mediaFileAttach,function(e){return i("li",{key:e.Id,staticClass:"file-attach-list",on:{click:function(i){return i.stopPropagation(),i.preventDefault(),t.previewVideo(e)}}},[i("attach-list",{attrs:{isEdit:t.isEdit,attachList:e},on:{deleteFile:t.deleteFile}})],1)}),0)]):t._e(),t._v(" "),t.officeFileAttach.length>0?i("div",{staticClass:"file-attach-type"},[i("h1",{staticClass:"type-title"},[t._v("文档")]),t._v(" "),i("ul",{staticClass:"file-attach-lists"},t._l(t.officeFileAttach,function(e){return i("li",{key:e.Id,staticClass:"file-attach-list",on:{click:function(i){return i.stopPropagation(),i.preventDefault(),t.showFile(e)}}},[i("attach-list",{attrs:{isEdit:t.isEdit,attachList:e},on:{deleteFile:t.deleteFile}})],1)}),0)]):t._e(),t._v(" "),t.otherFileAttach.length>0?i("div",{staticClass:"file-attach-type"},[i("h1",{staticClass:"type-title"},[t._v("其他")]),t._v(" "),i("ul",{staticClass:"file-attach-lists"},t._l(t.otherFileAttach,function(e){return i("li",{key:e.Id,staticClass:"file-attach-list",on:{click:function(i){return i.stopPropagation(),i.preventDefault(),t.showFile(e)}}},[i("attach-list",{attrs:{isEdit:t.isEdit,attachList:e},on:{deleteFile:t.deleteFile}})],1)}),0)]):t._e()]),t._v(" "),t.isEdit?i("div",{directives:[{name:"show",rawName:"v-show",value:100===t.offset,expression:"offset === 100"}],staticClass:"attach-action",on:{click:t.upLoad}},[i("svg",{staticClass:"vux-x-icon vux-x-icon-ios-plus-empty",attrs:{type:"ios-plus-empty",size:"40",xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 512 512"}},[i("path",{attrs:{d:"M384 265H264v119h-17V265H128v-17h119V128h17v120h120v17z"}})])]):t._e()]),t._v(" "),i("div",{staticClass:"iframe-wrap",style:{transform:"translate3d("+this.offset+"%, 0, 0)"}},[i("iframe",{staticClass:"iframe",attrs:{src:t.fileLink,frameborder:"0"}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.offset<=100,expression:"offset <= 100"}],staticClass:"back-wrap",on:{click:t.closeFile}},[i("span",{staticClass:"fa fa-reply"})])]),t._v(" "),i("player",{ref:"player"})],1)},staticRenderFns:[]};var m=i("VU/8")(p,v,!1,function(t){i("b/VP")},"data-v-153deb4e",null);e.default=m.exports},"b/VP":function(t,e){},tFWz:function(t,e,i){"use strict";var a=i("Mlu6"),s={mixins:[i("F4+m").a],props:{attachList:{type:Object,default:function(){return{UpdHumName:"附件测试",avatar:"./fileVideo.png",Name:"fileVideo.png",id:""}}},isEdit:{type:Boolean,default:!1}},created:function(){this.host=Object(a.s)("production")},methods:{deleteFile:function(t){this.$emit("deleteFile",t)},_formatDate:function(t){return Object(a.h)(t)},getFileIconLink:function(t){return Object(a.n)(t)}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"attach-list"},[i("div",{staticClass:"list-unit avatar-box"},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.getFileIconLink(t.attachList),expression:"getFileIconLink(attachList)"}],attrs:{alt:""}})]),t._v(" "),i("div",{staticClass:"list-unit title-box"},[i("p",{staticClass:"list-title list-unit-date"},[i("span",[t._v(t._s(this._formatDate(t.attachList.UpdDate)))]),t._v(" "),i("span",{staticClass:"up-load-HuName"},[t._v("上传人: "+t._s(t.attachList.UpdHumName))])]),t._v(" "),i("p",{staticClass:"list-title list-unit-title"},[t._v(t._s(t.attachList.Name)+t._s(t.attachList.FileExt))])]),t._v(" "),t.isEdit?i("div",{staticClass:"list-unit delete-box"},[i("div",{staticClass:"close-icon",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.deleteFile(t.attachList)}}},[i("svg",{staticClass:"vux-x-icon vux-x-icon-ios-close-empty",attrs:{type:"ios-close-empty",size:"30",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 512 512"}},[i("path",{staticClass:"st0",attrs:{d:"M340.2 160l-84.4 84.3-84-83.9-11.8 11.8 84 83.8-84 83.9 11.8 11.7 84-83.8 84.4 84.2 11.8-11.7-84.4-84.3 84.4-84.2z"}})])])]):t._e()])},staticRenderFns:[]};var o=i("VU/8")(s,l,!1,function(t){i("MGFQ")},"data-v-6b71285e",null);e.a=o.exports}});
//# sourceMappingURL=3.4876b4f24340c30319c5.js.map