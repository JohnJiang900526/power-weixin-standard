webpackJsonp([19],{cj7Z:function(t,e){},yuvn:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("woOf"),s=i.n(a),o=i("Gu7T"),l=i.n(o),r=i("Dd8w"),n=i.n(r),c=i("NYxO"),h=i("bGai"),m=i("Mlu6"),d=i("F4+m"),u=i("gyMJ"),b={mixins:[d.a],props:{KeyValue:{type:String,default:""},comboboxdata:{type:Object,default:function(){return{}}},formAllConfig:{type:Object,default:function(){return{}}},chileTableItem:{type:Object,default:function(){return{}}},tableData:{type:Object,default:function(){return{}}},mainformData:{type:Object,default:function(){return{}}}},computed:n()({isEdit:function(){var t=this.routerParams.formstate;switch(this.formStatusValue){case"40":case"50":return!1;default:return"view"!==t}}},Object(c.c)(["routerParams","formStatusValue"])),data:function(){return{KeyWord:"",formState:"",showCheckBox:!1,tagShow:!1,offset:100,tableLists:[],defaultData:[],selectItems:[],currentItem:{},tableShowField:[],option:{title:{text:"",show:!0},left:{text:"",show:!0},center:{text:"",show:!0},right:{text:"",show:!0}},subTableData:[],subTableTextNameOption:{},subTableShowField:[],tableType:"",selectId:"",submit:!1,mx_isLoading:!1,mx_message:"",mx_alertShow:!1,mx_alertTitle:"提示",mx_toastShow:!1,mx_toastText:"",mx_deleyTime:1e3}},mounted:function(){this.formState=this.routerParams.formstate,this.tableInit()},methods:n()({verifyRequireError:function(t,e){this.submit=!0;var i=[].concat(l()(e)).filter(function(t){if(t.required)return t});if(0===i.length)return!1;for(var a=0;a<i.length;a++){if(!t[i[a].field])return!0}return!1},tableInit:function(){var t=this.chileTableItem.textNameOption,e=this.chileTableItem.tableListType,i=this.chileTableItem.subTable;this.tableShowField=this.chileTableItem.tableShowField,this.option=s()(this.option,t),this.KeyWord=this.chileTableItem.KeyWord,this.tableType=Object(m.q)(e),i&&"withCommonTable"===i&&(this.subTableTextNameOption=this.chileTableItem.subTableTextNameOption,this.subTableShowField=this.chileTableItem.subTableShowField)},formRowChange:function(t){this.currentItem[t.field]=t.value},_add:function(){var t=this.chileTableItem.addType,e=this.routerParams.formstate;"fromWizard"===t?this.MixinAlertShowEvent("仅限查看,不能新增"):"view"===e?this.MixinAlertShowEvent("仅限查看,不能新增"):"add"===e?this.MixinAlertShowEvent("目前处于新增状态,请保存主表"):(this.addFormLoad(),this.offset=0)},saveFromData:function(){var t=this,e="auto",i=this.chileTableItem.data.foreignfield,a=this.chileTableItem.KeyWordType;if(Object(m.a)(i,this.currentItem)){if(e="add","0000"===this.KeyValue)return this.MixinAlertShowEvent("需先保存主表"),!1;this.currentItem=Object(m.z)(i,this.currentItem,this.mainformData,!0)}else e="edit";var s={KeyWord:this.KeyWord,formAllConfig:this.formAllConfig,KeyWordType:a,data:[this.currentItem],formDate:e,FormId:this.routerParams.FromId};if(this.tableShowField.forEach(function(t){t.required=!0}),this.verifyRequireError(this.currentItem,this.tableShowField))return this.AlertShowEvent("请补充必填项"),!1;var o=Object(m.t)(s);this.MinXinHttpFetch(Object(u.j)(o),function(e){e.success?(t.mx_toastText="保存成功",t.mx_toastShow=!0,t.$emit("saveChildFrom"),t.closeEditBlock()):t.currentItem=Object(m.z)(i,t.currentItem,t.mainformData,!1)})},deleteSelectedItems:function(){var t=this,e={KeyWord:this.KeyWord,formAllConfig:this.formAllConfig,KeyWordType:"BO",data:this.selectItems,formDate:"delete",FormId:this.routerParams.FromId},i=Object(m.t)(e);this.MinXinHttpFetch(Object(u.j)(i),function(e){e.success&&(t.mx_toastText="删除成功",t.mx_toastShow=!0,t.$emit("saveChildFrom"),t._backPre())})},addFormLoad:function(){var t=this,e={KeyWord:this.KeyWord,KeyValue:"",KeyWordType:"BO",swhere:"",select:"",formstate:"add"};this.MinXinHttpFetch(Object(u.i)(e),function(e){var i=e.data.value;t.currentItem=JSON.parse(i)})},selectItemView:function(t){if(this.showCheckBox)return!1;this.currentItem=Object(m.j)(this.comboboxdata,t,this.KeyWord),this.offset=0;var e=this.chileTableItem.subTable;"withAttach"===e&&this.$refs.subFileAttach.GetDocFilesLoad(this.KeyWord,this.currentItem.Id),"withCommonTable"===e&&(this.selectId=t.Code)},_backPre:function(){var t=this.$refs.formListUnit;t&&0!==t.length&&t.forEach(function(t){t.backDefault()}),this.showCheckBox=!1,this.selectItems=[]},_delete:function(){var t=this.chileTableItem.addType,e=this.routerParams.formstate;"fromWizard"===t?this.MixinAlertShowEvent("仅限查看,不能删除"):"view"===e?this.MixinAlertShowEvent("仅限查看,不能删除"):"add"===e?this.MixinAlertShowEvent("目前处于新增状态,请保存主表"):this.deleteSelectedItems()},_preDelete:function(){this.showCheckBox=!0},_selectItem:function(t){this.selectItems.push(t)},_unSelectItem:function(t){Object(m.w)(this.selectItems,t)},closeEditBlock:function(){this.offset=100}},Object(c.b)(["AlertShowEvent","ToastShowEvent"])),watch:{tableData:{handler:function(t,e){t.values||(t.values=[]),"withCommonTable"===this.chileTableItem.subTable&&(this.subTableData=s()({},t)),this.tableLists=t.values.concat()},immediate:!0}},components:{SearchBox:h.m,FormList:h.f,FooterBar:h.d,FormRow:h.g,subFileAttach:h.s,SubCommonTable:h.n}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chile-table-unit"},[i("div",{staticClass:"child-main-content"},[i("form",{staticClass:"child-main-table"},[i("ul",{staticClass:"child-table-lists"},["table"===t.tableType?i("li",{staticClass:"table-title"},[i("div",{staticClass:"title-wrap"},[t.option.title.show?i("div",{staticClass:"title-item"},[i("span",{staticClass:"text"},[t._v(t._s(t.option.title.text))])]):t._e(),t._v(" "),t.option.left.show?i("div",{staticClass:"title-item"},[i("span",{staticClass:"text"},[t._v(t._s(t.option.left.text))])]):t._e(),t._v(" "),t.option.center.show?i("div",{staticClass:"title-item"},[i("span",{staticClass:"text"},[t._v(t._s(t.option.center.text))])]):t._e(),t._v(" "),t.option.right.show?i("div",{staticClass:"title-item"},[i("span",{staticClass:"text"},[t._v(t._s(t.option.right.text))])]):t._e()])]):t._e(),t._v(" "),t._l(t.tableLists,function(e){return t.tableLists.length?i("li",{key:e.Id,staticClass:"table-list",on:{click:function(i){t.selectItemView(e)}}},[i("form-list",{ref:"formListUnit",refInFor:!0,attrs:{item:e,showCheckBox:t.showCheckBox,tagShow:t.tagShow,option:t.option,tableType:t.tableType,KeyWord:t.KeyWord,comboboxdata:t.comboboxdata},on:{selectItem:t._selectItem,unSelectItem:t._unSelectItem}})],1):t._e()})],2)]),t._v(" "),t.isEdit?i("footer-bar",{on:{Add:t._add,preDelete:t._preDelete,Delete:t._delete,backPre:t._backPre}}):t._e()],1),t._v(" "),i("div",{staticClass:"chile-table-lists-form",style:{transform:"translate3d("+this.offset+"%, 0, 0)"}},[i("form",{staticClass:"input-textarea-group"},[t.tableShowField.length>0?i("div",t._l(t.tableShowField,function(e,a){return i("form-row",{key:a,attrs:{label:e.title,type:e.format,readonly:e.readonly,required:e.required,disabled:e.disabled,placeholder:e.placeholder,field:e.field,KeyWord:t.KeyWord,fieldItem:e,mainformData:t.currentItem,comboboxdata:t.comboboxdata,submit:t.submit},on:{enterChange:t.formRowChange}})})):t._e(),t._v(" "),"withAttach"===t.chileTableItem.subTable?i("div",{staticClass:"sub-file-attach-warp"},[i("h1",{staticClass:"sub-file-attach-title font-color-active"},[t._v("附件列表:")]),t._v(" "),i("sub-file-attach",{ref:"subFileAttach",attrs:{KeyWord:t.KeyWord,KeyValue:t.currentItem.Id}})],1):t._e(),t._v(" "),"withCommonTable"===t.chileTableItem.subTable?i("div",{staticClass:"sub-file-attach-warp"},[i("h1",{staticClass:"sub-file-attach-title font-color-active"},[t._v("请购明细:")]),t._v(" "),i("sub-common-table",{attrs:{tableTextNameOption:t.subTableTextNameOption,tableShowField:t.subTableShowField,tableData:t.subTableData,tableType:t.tableType,comboboxdata:t.comboboxdata,selectId:t.selectId}})],1):t._e()]),t._v(" "),i("div",{staticClass:"footer-actions"},[t.isEdit?i("div",{staticClass:"action-item",on:{click:t.saveFromData}},[t._v("保存")]):t._e(),t._v(" "),i("div",{staticClass:"action-item",on:{click:t.closeEditBlock}},[t._v("关闭")])])]),t._v(" "),i("loading",{model:{value:t.mx_isLoading,callback:function(e){t.mx_isLoading=e},expression:"mx_isLoading"}}),t._v(" "),i("toast",{attrs:{type:"text",time:t.mx_deleyTime},model:{value:t.mx_toastShow,callback:function(e){t.mx_toastShow=e},expression:"mx_toastShow"}},[t._v(t._s(t.mx_toastText))]),t._v(" "),i("alert",{attrs:{title:t.mx_alertTitle,content:t.mx_message},on:{"on-hide":t.MixinAlertHideEvent},model:{value:t.mx_alertShow,callback:function(e){t.mx_alertShow=e},expression:"mx_alertShow"}})],1)},staticRenderFns:[]};var v=i("VU/8")(b,f,!1,function(t){i("cj7Z")},"data-v-51e20e78",null);e.default=v.exports}});
//# sourceMappingURL=19.e6e239cf2e91cdb417f6.js.map